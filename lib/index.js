"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=_interopDefault(require("react"));function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},i=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),i.forEach(function(e){_defineProperty(t,e,a[e])})}return t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _isExist(){for(var e=arguments,t=0;t<e.length;t++){var a=e[t];if(""===a||null==a)return!1}return!0}function _isSetLineDash(e,t){Array.isArray(e)&&2===e.length&&"function"==typeof t&&t(e)}function _deepCopy(e){var t=isType(e);return"Array"===t||"Object"===t?cloneObj(e):"Date"===t?e.constructor(e):e}function cloneObj(e){var t=e instanceof Array?[]:{};for(var a in e)t[a]="object"===_typeof(e[a])?cloneObj(e[a]):e[a];return t}function isType(e){return/\[object\s(.*?)\]/.exec(Object.prototype.toString.call(e))[1]}function _getRate(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return _isExist(e,t)&&0<=e&&0<t?e/t:0}function _getMax(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"key",i=[];return e.map(function(e,t){isNaN(e[a])||i.push(e[a])}),0<i.length?Math.max.apply(null,i):0}function _getCtx(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"2d";return _isExist(e)&&this.refs[e]&&this.refs[e].getContext(t)}function DrawCartCoor(){var R=[0,0],j=[100,100];function P(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:R,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:j,a=e[0]!==t[0]&&e[1]===t[1],i=e[0]===t[0]&&e[1]!==t[1];return{drawX:a,drawY:i,flag:a||i}}this._drawCoor=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=e.show,i=e.begin,n=void 0===i?R:i,r=e.end,o=void 0===r?j:r,l=e.strokeStyle,s=void 0===l?"#000":l,d=e.lineWidth,h=void 0===d?2:d,c=e.lineCap,u=void 0===c?"round":c,f=e.setLineDash,p=P(n,o).flag;a&&p&&(t.save(),t.beginPath(),_isSetLineDash(f,function(e){t.setLineDash(e)}),t.moveTo.apply(t,n),t.lineTo.apply(t,o),t.strokeStyle=s,t.lineWidth=h,t.lineCap=u,t.stroke(),t.restore())},this._drawScale=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=t.begin,i=void 0===a?R:a,n=t.end,r=void 0===n?j:n,o=t.strokeStyle,l=void 0===o?"#000":o,s=t.scaleNum,d=void 0===s?5:s,h=t.scaleLength,c=void 0===h?0:h,u=t.lineWidth,f=void 0===u?2:u,p=t.startIndex,y=void 0===p?0:p,b=t.endIndex,v=void 0===b?d:b,g=P(i,r),_=g.drawX,w=g.drawY;if(g.flag&&0<d){var k,m,S,C,L=(r[0]-i[0])/(d-1),D=(r[1]-i[1])/(d-1);e.save();for(var x=y;x<v;x++)S=(k=i[0]+L*x)+(w?c:0),C=(m=i[1]+D*x)+(_?c:0),e.beginPath(),e.moveTo(k,m),e.lineTo(S,C),e.lineWidth=f,e.strokeStyle=l,e.stroke();e.restore()}},this._drawGrid=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=e.begin,i=void 0===a?R:a,n=e.end,r=void 0===n?j:n,o=e.show,l=e.gridNum,s=void 0===l?5:l,d=e.strokeStyle,h=void 0===d?"#000":d,c=e.lineWidth,u=void 0===c?1:c,f=e.setLineDash,p=void 0===f?[4,4]:f,y=e.gridLength,b=P(i,r),v=b.drawX,g=b.drawY,_=b.flag;if(o&&_&&0<s){var w,k,m,S,C=(r[0]-i[0])/(s-1),L=(r[1]-i[1])/(s-1);t.save();for(var D=1;D<s;D++)m=(w=i[0]+C*D)+(g?y:0),S=(k=i[1]+L*D)+(v?y:0),t.beginPath(),_isSetLineDash(p,function(e){t.setLineDash(e)}),t.moveTo(w,k),t.lineTo(m,S),t.lineWidth=u,t.strokeStyle=h,t.stroke();t.restore()}},this._drawLabel=function(e){var t,a,i,n,r,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},l=o.key,s=(o.label,o.labelNum),d=void 0===s?2:s,h=o.begin,c=void 0===h?R:h,u=o.end,f=void 0===u?j:u,p=o.data,y=void 0===p?[]:p,b=P(c,f),v=b.drawX,g=b.drawY,_=y.length;if(e.save(),v){t=(f[0]-c[0])/(_-1),a=(f[1]-c[1])/(_-1);for(var w=0;w<_;w++)i=c[0]+t*w,n=c[1]+a*w,r=y[w][l],e.textAlign="center",e.textBaseline="top",e.fillText(isNaN(r)?r:Math.round(r),i,n+5)}else if(g){for(var k,m,S=0,C=0;C<l.length;C++)S=Math.max(S,_getMax(y,l[C]));k=S/(d-1),t=(f[0]-c[0])/(d-1),m=(f[1]-c[1])/(d-1);for(var L=r=0;L<d;L++)i=c[0]+t*L,n=c[1]+m*L,e.textAlign="end",e.textBaseline="middle",e.fillText(isNaN(r)?r:Math.round(r),i-5,n),r+=k}else e.restore()},this._drawDataBlock=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=e.rectWidth,i=(e.rectHeight,e.lineWidth),n=e.setLineDash,r=e.lineHeight,o=e.fillStyle,l=e.xCoor,s=e.yCoor,d=e.data,h=void 0===d?[]:d,c=e.scale,u=e.xKey,f=e.yKey,p=e.yLabel,y=e.fontColor,b=h.length,v=(l.end[0]-l.begin[0])/(b-1);t.save();for(var g=0;g<h.length;g++){var _=l.begin[0]+v*g;if(Math.abs(c[0]-_)<Math.abs(v)/2){t.save(),t.beginPath(),_isSetLineDash(n,function(e){t.setLineDash(e)}),t.moveTo(_,l.begin[1]),t.lineTo(_,s.end[1]),t.lineWidth=i,t.strokeStyle="#000",t.stroke(),t.restore();var w=_+5,k=c[1],m=k,S=0;for(var C in g>h.length/2&&(w=_-a-5),h[g])S+=r;for(var L in t.beginPath(),t.fillStyle=o,t.fillRect(w,k,a,S),t.textBaseline="top",h[g])u===L&&(t.strokeText("".concat(h[g][L]),w+5,m),t.stroke()),-1<f.indexOf(L)&&(t.strokeStyle=y[f.indexOf(L)%y.length],t.strokeText("".concat(p[f.indexOf(L)]||L,":").concat(h[g][L]),w+5,m),t.stroke()),m+=r;break}}t.restore()}}function DrawPolarCoor(){this._setCenter=function(e,t){e.translate.apply(e,t)},this._drawCenterDot=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=t.radius,i=void 0===a?3:a,n=t.fill,r=t.stroke,o=t.fillStyle,l=t.strokeStyle;e.save(),e.beginPath(),e.arc(0,0,i,0,2*Math.PI),n&&(e.fillStyle=o,e.fill()),r&&(e.strokeStyle=l,e.stroke()),e.closePath(),e.restore()},this._drawLabel=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=t.fillStyle,i=t.textGap,n=t.font,r=t.radius,o=t.label,l=t.rad,s=t.index,d=Math.round(r*Math.sin(l*s)),h=-Math.round(r*Math.cos(l*s));0<d?d+=i:d<0&&(d-=i),0<h?h+=i:h<0&&(h-=i),e.font=n,e.textAlign="center",e.textBaseline="middle",Array.isArray(a)&&0<a.length&&(e.fillStyle=a[s%a.length]),e.fillText(o,d,h)}}var DrawLine=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,DrawCartCoor),_createClass(t,[{key:"_drawLineCoor",value:function(){this._drawCoor.apply(this,arguments)}},{key:"_drawLineScale",value:function(){this._drawScale.apply(this,arguments)}},{key:"_drawLineGrid",value:function(){this._drawGrid.apply(this,arguments)}},{key:"_drawLineLabel",value:function(){this._drawLabel.apply(this,arguments)}},{key:"_drawLineDataBlock",value:function(){this._drawDataBlock.apply(this,arguments)}},{key:"_drawLineData",value:function(r){for(var o,l,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=e.data,a=void 0===t?[]:t,i=e.key,n=void 0===i?[]:i,s=e.xCoor,d=e.yCoor,h=e.strokeStyle,c=void 0===h?[]:h,u=e.lineWidth,f=void 0===u?3:u,p=e.line,y=void 0===p||p,b=e.dot,v=void 0===b||b,g=e.dotRadius,_=void 0===g?4:g,w=(s.end[0]-s.begin[0])/(a.length-1),k=d.end[1]-d.begin[1],m=0,S=0;S<n.length;S++)m=Math.max(m,_getMax(a,n[S]));y&&n.map(function(i,e){r.beginPath(),a.map(function(e,t){if(0<=e[i]){var a=e[i];o=s.begin[0]+w*t,l=_getRate(a,m)*k+d.begin[1],0===t&&r.moveTo(o,l),0<t&&r.lineTo(o,l)}}),r.strokeStyle=c[e%c.length],r.lineWidth=f,r.stroke()}),v&&n.map(function(i,n){a.map(function(e,t){if(0<=e[i]){var a=e[i];o=s.begin[0]+w*t,l=_getRate(a,m)*k+d.begin[1],r.beginPath(),r.arc(o,l,_,0,2*Math.PI),r.fillStyle=c[n%c.length],r.fill()}})})}}]),t}(),DrawRadar=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,DrawPolarCoor),_createClass(t,[{key:"_getDataDotPos",value:function(e,a){var i,n,t=e.data,r=e.length,o=2*Math.PI/t.length;t.map(function(e,t){i=r*Math.sin(o*t),n=-r*Math.cos(o*t),"function"==typeof a&&a([i,n],e,t)})}},{key:"_setRadarCenter",value:function(){this._setCenter.apply(this,arguments)}},{key:"_drawRadarCenterDot",value:function(){this._drawCenterDot.apply(this,arguments)}},{key:"_drawRadarLabel",value:function(a){var i=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=n.labelKey,e=n.data,o=2*Math.PI/e.length;a.save(),e.map(function(e,t){i._drawLabel(a,_objectSpread({},n,{label:e[r]||"",rad:o,index:t}))}),a.restore()}},{key:"_drawRadarScale",value:function(i){for(var e,n,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=t.lineWidth,r=t.strokeStyle,o=t.scaleNum,l=t.setLineDash,s=t.data,d=t.radius,h=t.dataKey,c=isNaN(d/o)?20:d/o,u=0,f=0;f<h.length;f++)u=Math.max(u,_getMax(s,h[f]));i.save();for(var p=0;p<o;p++)e=c*(p+1),n=Math.round(u/o*(p+1)),i.beginPath(),this._getDataDotPos({data:s,length:e},function(e,t,a){0===a&&i.moveTo.apply(i,e),0===a&&i.fillText.apply(i,[n].concat(_toConsumableArray(e))),0<a&&i.lineTo.apply(i,e)}),i.lineWidth=a,i.strokeStyle=r,_isSetLineDash(l,function(e){i.setLineDash(e)}),i.closePath(),i.stroke();i.restore()}},{key:"_drawRadarGuide",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=e.show,i=e.setLineDash,n=e.lineWidth,r=e.strokeStyle,o=e.data,l=e.radius;t.save(),t.beginPath(),a&&this._getDataDotPos({data:o,length:l},function(e){t.moveTo(0,0),t.lineTo.apply(t,e),t.lineWidth=n,t.strokeStyle=r,_isSetLineDash(i,function(e){t.setLineDash(e)}),t.stroke()}),t.restore()}},{key:"_drawRadarData",value:function(l){for(var e=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=t.stroke,i=t.fill,s=t.strokeStyle,d=t.fillStyle,h=t.setLineDash,c=t.lineWidth,n=t.dataKey,u=t.data,f=t.radius,p=0,r=0;r<n.length;r++)p=Math.max(p,_getMax(u,n[r]));l.save(),n.map(function(r,o){l.beginPath(),e._getDataDotPos({data:u,length:f},function(e,t,a){var i=_getRate(t[r],p),n=e.map(function(e){return e*i});0===a&&l.moveTo.apply(l,n),0<a&&l.lineTo.apply(l,n),l.lineWidth=c,_isSetLineDash(h,function(e){l.setLineDash(e)}),l.strokeStyle=s[o%s.length],l.fillStyle=d[o%d.length]}),l.closePath(),a&&l.stroke(),i&&l.fill()}),l.restore()}}]),t}();function _drawLine(){return new DrawLine}function _drawRadar(){return new DrawRadar}function styleInject(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===a&&i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}var css=".radar_all {\n  position: relative;\n}\n.radar_canvas {\n  position: absolute;\n  top: 0;\n  left: 0;\n  border: 1px solid #000;\n}\n.radar_tooltip {\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-wrap: nowrap;\n}\n.radar_tooltip > div {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-wrap: nowrap;\n  font-size: 14px;\n  cursor: pointer;\n}\n.radar_tooltip > div:not(last-child) {\n  margin-right: 10px;\n}\n";styleInject(css);var obj=_drawRadar(),_setRadarCenter=obj._setRadarCenter.bind(obj),_drawRadarCenterDot=obj._drawRadarCenterDot.bind(obj),_drawRadarScale=obj._drawRadarScale.bind(obj),_drawRadarLabel=obj._drawRadarLabel.bind(obj),_drawRadarGuide=obj._drawRadarGuide.bind(obj),_drawRadarData=obj._drawRadarData.bind(obj),Radar=function(e){function a(e){var t;return _classCallCheck(this,a),(t=_possibleConstructorReturn(this,_getPrototypeOf(a).call(this,e))).state={canvasId:["back"],lengthLimit:3,tooltipPro:{},center:[],props:{},formatData:[]},t}return _inherits(a,React.Component),_createClass(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({props:this.props,formatData:_deepCopy(this.props.data)},function(){return e.init()})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({props:e,formatData:_deepCopy(e.data)},function(){return t.init()})}},{key:"init",value:function(e){var t=this,a=this.state.canvasId,i=this.state.props,n=i.width,r=i.height,o=_getCtx.call(this,a[0]),l=[Math.round(n/2),Math.round(r/2)];this.setState({center:l},function(){t.drawRadar(o,e),t.drawTooltip(o)})}},{key:"drawRadar",value:function(e){var t=this.state,a=t.lengthLimit,i=t.center,n=t.formatData,r=this.state.props,o=r.width,l=r.height,s=r.radius,d=r.centerDot,h=r.scale,c=r.label,u=r.guide,f=r.dataRender;e.clearRect(0,0,o,l),n&&n.length>=a&&(_setRadarCenter(e,i),_drawRadarGuide(e,_objectSpread({},u,{data:n,radius:s})),_drawRadarScale(e,_objectSpread({},h,{data:n,radius:s,dataKey:f.dataKey})),_drawRadarLabel(e,_objectSpread({},c,{data:n,radius:s})),_drawRadarCenterDot(e,_objectSpread({},d)),_drawRadarData(e,_objectSpread({},f,{data:n,radius:s})),_setRadarCenter(e,i=[-i[0],-i[1]]))}},{key:"drawTooltip",value:function(e){var a=this,t=this.state.tooltipPro,i=this.state.props,n=i.width,r=i.tooltip,o=i.dataRender,l=r.position,s=r.childLineHeight,d=r.childLineWidth,h=r.height,c=r.disabledColor,u=o.stroke,f=o.fill,p=o.strokeStyle,y=o.fillStyle,b=o.dataKey,v=o.dataLabel;if(!t.key||0===t.key.length){t.key=[];for(var g=0;g<b.length;g++)t.key.push({show:!0,key:b[g],label:v[g]||b[g]})}var _={width:n,height:h};_[l]=0,t.node=React.createElement("div",{className:"radar_tooltip",style:_},t.key.map(function(e,t){return React.createElement("div",{key:e.key,onClick:function(){return a.changeData(e.key)}},React.createElement("div",{style:{height:s,width:d,marginRight:5,background:e.show&&f?y[t%y.length]:c,border:e.show&&u?"1px solid ".concat(p[t%p.length]):c}}),React.createElement("div",{style:{color:e.show?"#000":c}},e.label))})),this.setState({tooltipPro:t})}},{key:"changeData",value:function(e){for(var t=this,a=this.state,i=a.tooltipPro,n=a.formatData,r=this.state.props.data,o=0;o<n.length;o++)_isExist(n[o][e])?delete n[o][e]:n[o][e]=r[o][e];for(var l=0;l<i.key.length;l++)e===i.key[l].key&&(i.key[l].show=!i.key[l].show);this.setState({formatData:n,tooltipPro:i},function(){return t.init()})}},{key:"render",value:function(){var e=this.state,t=e.canvasId,a=e.tooltipPro,i=this.state.props,n=i.width,r=i.height;return React.createElement("div",{className:"radar_all",style:{width:n,height:r}},t&&t.map(function(e,t){return React.createElement("canvas",{key:e,ref:e,width:n,height:r,className:"radar_canvas"})}),a.node)}}]),a}();Radar.defaultProps={width:450,height:450,radius:150,centerDot:{radius:5,fill:!0,fillStyle:"#5d9",stroke:!1,strokeStyle:"#5d9cec"},scale:{lineWidth:5,strokeStyle:"#5d9",scaleNum:3},guide:{show:!0,setLineDash:[4,4],lineWidth:2,strokeStyle:"#ddd"},label:{labelKey:"label",fillStyle:["red","green","blue"],textGap:20,font:"16px Arial"},dataRender:{stroke:!0,strokeStyle:["#5d9","#5d9cec","#ff0000"],fill:!0,fillStyle:["rgba(85,221,153,.5)","rgba(93,156,236,.5)","rgba(255,0,0,.5)"],lineWidth:2,dataKey:["A","B","C"],dataLabel:["stuA","stuB","stuC"]},tooltip:{position:"bottom",childLineHeight:5,childLineWidth:40,height:60,disabledColor:"#ddd"},data:[{label:"语文",A:120,B:90,C:130},{label:"数学",A:140,B:150,C:130},{label:"英语",A:130,B:90,C:130},{label:"历史",A:90,B:80,C:100},{label:"政治",A:95,B:60,C:100},{label:"地理",A:80,B:75,C:100},{label:"历史",A:90,B:80,C:100},{label:"政治",A:95,B:60,C:100},{label:"地理",A:80,B:75,C:100}]};var css$1=".line_all {\n  position: relative;\n}\n.line_canvas {\n  position: absolute;\n  top: 0;\n  left: 0;\n  border: 1px solid #000;\n}\n.line_title,\n.line_tooltip {\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-wrap: nowrap;\n}\n.line_title > div,\n.line_tooltip > div {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-wrap: nowrap;\n  font-size: 14px;\n  cursor: pointer;\n}\n.line_title > div:not(last-child),\n.line_tooltip > div:not(last-child) {\n  margin-right: 10px;\n}\n";styleInject(css$1);var obj$1=_drawLine(),_drawLineCoor=obj$1._drawLineCoor.bind(obj$1),_drawLineScale=obj$1._drawLineScale.bind(obj$1),_drawLineGrid=obj$1._drawLineGrid.bind(obj$1),_drawLineLabel=obj$1._drawLineLabel.bind(obj$1),_drawLineData=obj$1._drawLineData.bind(obj$1),_drawLineDataBlock=obj$1._drawLineDataBlock.bind(obj$1),Line=function(e){function a(e){var t;return _classCallCheck(this,a),(t=_possibleConstructorReturn(this,_getPrototypeOf(a).call(this,e))).state={canvasId:["back","data","block"],titleDOM:void 0,tooltipPro:{},xCoor:{},yCoor:{},props:{},formatData:[]},t.drawBlock=t.drawBlock.bind(_assertThisInitialized(t)),t}return _inherits(a,React.Component),_createClass(a,[{key:"getPosition",value:function(){var e=this.state.props.innerGap;return{top:e[0],right:e[1],bottom:e[2],left:e[3]}}},{key:"componentDidMount",value:function(){var e=this;this.setState({props:this.props,formatData:_deepCopy(this.props.data)},function(){return e.init()})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({props:e,formatData:_deepCopy(e.data)},function(){return t.init()})}},{key:"init",value:function(){var e=this,t=this.state.canvasId,a=this.state.props,i=a.width,n=a.height,r=this.getPosition(),o=r.top,l=r.right,s=r.bottom,d=r.left,h=_getCtx.call(this,t[0]),c=_getCtx.call(this,t[1]);this.refs[t[2]].addEventListener("mousemove",this.drawBlock),this.setState({xCoor:{begin:[d,n-s],end:[i-l,n-s]},yCoor:{begin:[d,n-s],end:[d,o]}},function(){e.drawBack(h),e.drawData(c),e.drawTitle(),e.drawTooltip()})}},{key:"drawBack",value:function(e){var t=this.state,a=t.xCoor,i=t.yCoor,n=t.formatData,r=this.state.props,o=r.width,l=r.height,s=r.axisX,d=r.axisY,h=r.scaleX,c=r.scaleY,u=r.gridX,f=r.gridY,p=r.labelX,y=r.labelY;r.dataLine;e.clearRect(0,0,o,l),_drawLineCoor(e,_objectSpread({},s,a)),_drawLineCoor(e,_objectSpread({},d,i)),_drawLineScale(e,_objectSpread({},s,a,h,{scaleNum:n.length})),_drawLineScale(e,_objectSpread({},d,i,c)),_drawLineGrid(e,_objectSpread({},s,a,u,{gridNum:n.length,gridLength:i.end[1]-i.begin[1]})),_drawLineGrid(e,_objectSpread({},d,i,f,{gridLength:a.end[0]-a.begin[0]})),_drawLineLabel(e,_objectSpread({},p,a,{data:n})),_drawLineLabel(e,_objectSpread({},y,i,{data:n}))}},{key:"drawData",value:function(e){var t=this.state,a=t.xCoor,i=t.yCoor,n=t.formatData,r=this.state.props,o=r.width,l=r.height,s=r.labelY,d=r.dataLine;r.data;e.clearRect(0,0,o,l),_drawLineData(e,_objectSpread({key:s.key,data:n,xCoor:a,yCoor:i},d))}},{key:"drawBlock",value:function(e){var t=this.getPosition(),a=t.top,i=t.right,n=t.bottom,r=t.left,o=this.state.props,l=o.width,s=o.height,d=o.labelX,h=o.labelY,c=o.dataLine,u=o.dataBlock,f=this.state,p=f.canvasId,y=f.xCoor,b=f.yCoor,v=f.formatData,g=_getCtx.call(this,p[2]),_=e.offsetX>=r&&e.offsetX<=l-i&&e.offsetY>=a&&e.offsetY<=s-n;g.clearRect(0,0,l,l),_?_drawLineDataBlock(g,_objectSpread({},u,{xCoor:y,yCoor:b,data:v,scale:[e.offsetX,e.offsetY],xKey:d.key,yKey:Array.isArray(h.key)&&h.key||[],yLabel:Array.isArray(h.label)&&h.label||[],fontColor:c.strokeStyle})):g.clearRect(0,0,l,s)}},{key:"drawTitle",value:function(){var e=this.state.props,t=e.width,a=e.title,i=a.position,n=a.label,r=a.style,o=void 0===r?{}:r;(o=_objectSpread({},o,{width:t}))[i]=0,this.setState({titleDOM:React.createElement("div",{className:"line_title",style:o},n)})}},{key:"drawTooltip",value:function(){var a=this,e=this.state.tooltipPro,t=this.state.props,i=t.width,n=t.tooltip,r=t.labelY,o=t.dataLine,l=n.position,s=n.childLineHeight,d=n.childLineWidth,h=n.height,c=n.disabledColor,u=r.key,f=r.label;if(!e.key||0===e.key.length){e.key=[];for(var p=0;p<u.length;p++)e.key.push({key:u[p],show:!0,label:f[p]||u[p]})}var y={width:i,height:h};y[l]=0,e.node=React.createElement("div",{className:"line_tooltip",style:y},e.key.map(function(e,t){return React.createElement("div",{key:e.key,onClick:function(){return a.changeData(e.key)}},React.createElement("div",{style:{height:s,width:d,marginRight:5,background:e.show?o.strokeStyle[t%o.strokeStyle.length]:c}}),React.createElement("div",{style:{color:e.show?"#000":c}},e.label))})),this.setState({tooltipPro:e})}},{key:"changeData",value:function(e){for(var t=this,a=this.state,i=a.tooltipPro,n=a.formatData,r=this.state.props.data,o=0;o<n.length;o++)_isExist(n[o][e])?delete n[o][e]:n[o][e]=r[o][e];for(var l=0;l<i.key.length;l++)e===i.key[l].key&&(i.key[l].show=!i.key[l].show);this.setState({formatData:n,tooltipPro:i},function(){return t.init()})}},{key:"render",value:function(){var e=this.state,t=e.canvasId,a=e.titleDOM,i=e.tooltipPro,n=(e.mouseEvent,this.state.props),r=n.width,o=n.height;n.coordinate;return React.createElement("div",{className:"line_all",style:{width:r,height:o}},t&&t.map(function(e,t){return React.createElement("canvas",{key:e,ref:e,width:r,height:o,className:"line_canvas"})}),a,i.node)}}]),a}();Line.defaultProps={width:1e3,height:500,innerGap:[60,40,70,40],axisX:{show:!0,strokeStyle:"#5d9cec",lineWidth:2,setLineDash:[]},axisY:{show:!0,strokeStyle:"#5d9cec",lineWidth:2,setLineDash:[]},scaleX:{scaleLength:0,strokeStyle:"#5d9",lineWidth:2},scaleY:{scaleNum:0,scaleLength:10,lineWidth:2},gridX:{show:!1,strokeStyle:"#000",lineWidth:1,setLineDash:[4,4]},gridY:{show:!0,gridNum:5,strokeStyle:"#000",lineWidth:1,setLineDash:[4,4]},labelX:{key:"x",label:"日期"},labelY:{key:["weight","IQ","EQ","NQ"],label:["体重","智商","情商","智障"],labelNum:5},dataLine:{strokeStyle:["red","green","blue","violet"],lineWidth:3,line:!0,dot:!0,dotRadius:4},tooltip:{position:"bottom",childLineHeight:5,childLineWidth:40,height:60,disabledColor:"#ddd"},title:{position:"top",label:"人体状况图（α测试）",style:{fontSize:16,color:"#000",height:60}},dataBlock:{rectWidth:100,lineWidth:1,setLineDash:[4,4],lineHeight:20,fillStyle:"rgba(93,156,236,.3)"},data:[{x:"2012-12-12",weight:200,IQ:300,EQ:138,NQ:100},{x:"2012-12-13",weight:100,IQ:200,EQ:500,NQ:150},{x:"2012-12-14",weight:200,IQ:100,EQ:172,NQ:89},{x:"2012-12-15",weight:150,IQ:0,EQ:146,NQ:200},{x:"2012-12-16",weight:200,IQ:100,EQ:250,NQ:165},{x:"2012-12-17",weight:100,IQ:200,EQ:125,NQ:138},{x:"2012-12-18",weight:200,IQ:300,EQ:250,NQ:50}]},exports.Line=Line,exports.Radar=Radar;
